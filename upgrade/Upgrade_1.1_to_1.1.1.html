<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1">
  
  <title>Upgrading to GeoGig 1.1.1 &mdash; GeoGig 1.2-SNAPSHOT Upgrading</title>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,700italic,800italic,300,700,600,800,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Cantarell:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="_static/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="_static/print.css" type="text/css" media="print" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
   <link rel="stylesheet" href="_static/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="_static/offcanvas.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.2-SNAPSHOT',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
  <link rel="shortcut icon" href="_static/favicon.ico"/>
      <link rel="index" title="Index" href="genindex.html" />
      <link rel="search" title="Search" href="search.html" />
      <link rel="top" title="GeoGig 1.2-SNAPSHOT Upgrading" href="index.html" />
      <link rel="next" title="Upgrading to GeoGig 1.2.0" href="Upgrade_1.1.1_to_1.2.html" />
      <link rel="prev" title="Upgrading to GeoGig 1.1" href="Upgrade_1.0_to_1.1.html" />
</head>
<body class="Upgrade_1.1_to_1.1.1">
    <div id="blacktop"></div>
    <header id="masthead">
      <div class="navbar">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://geogig.org"><h1>GeoGig</h1></a>
          </div>
          <div class="navbar-collapse collapse navbar-right">
            <ul class="nav navbar-nav">
              <li><a href="http://geogig.org/#install">Get Started</a></li>
              <li><a href="http://geogig.org/docs/index.html">Documentation</a></li>
              <li><a href="https://github.com/locationtech/geogig">On Github</a></li>
            </ul>
          </div><!--/.navbar-collapse -->
        </div>
      </div>
    </header>

    <section class="subheading hidden-xs">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            <p class="byline">A Tool for Geospatial Data Management</p>
          </div>
        </div>
      </div>
    </section>
    <a name="top"></a>

 <div id="main">
    <div class="wrap selfclear">
      <div id="content">
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-right">
          <div class="col-md-8">
            <div class="row pull-right">
             <div class="visible-sm visible-xs" id="menu-btn">
                <button class="btn btn-blue btn-sm"type="button" data-toggle="offcanvas">
                  <span class="btn-text active">Menu &rarr;</span>
                  <span class="btn-back">&larr; Back</span>
                </button>
              </div>
            </div>
<ul id="breadcrumbs">
  
  <li><a href="index.html">GeoGig 1.2-SNAPSHOT Upgrading</a> &raquo;</li>
  <li>Upgrading to GeoGig 1.1.1</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="genindex.html" title="General Index"
       accesskey="I">index</a></li>
  <li>
    <a href="Upgrade_1.1.1_to_1.2.html" title="Upgrading to GeoGig 1.2.0"
       accesskey="N">next</a>|</li>
  <li>
    <a href="Upgrade_1.0_to_1.1.html" title="Upgrading to GeoGig 1.1"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="upgrading-to-geogig-1-1-1">
<h1>Upgrading to GeoGig 1.1.1<a class="headerlink" href="#upgrading-to-geogig-1-1-1" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Ensure you have your repository database fully backed up before moving to GeoGig 1.1.1</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This guide centered around a PostgreSQL GeoGig backend.  If you are using a RocksDB backend, please modify the command so they point to your RocksDB.</p>
</div>
<div class="section" id="upgrading-existing-repositories">
<h2>Upgrading existing repositories<a class="headerlink" href="#upgrading-existing-repositories" title="Permalink to this headline">¶</a></h2>
<p>Our recommendation is to use GeoGig 1.1.1 to <cite>clone</cite>
your existing repository into a new repository (in a new database).
We also strongly recommend first validating a test system before attempting to upgrade a production server.
Here is a simple process to do this;</p>
<ol class="arabic">
<li><p class="first">Backup your existing databases (use existing PostgreSQL tools)</p>
</li>
<li><p class="first">Create a new PostgreSQL database</p>
</li>
<li><p class="first">Use GeoGig 1.1.1 to <cite>clone</cite> the existing repository into the new database</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geogig</span> <span class="n">clone</span> <span class="s2">&quot;postgresql://OLDdatabase/&lt;repo&gt;&quot;</span> <span class="s2">&quot;postgresql://NEWdatabase/&lt;repo&gt;&quot;</span>
</pre></div>
</div>
</li>
<li><p class="first">Create QuadTree indexes in the new repository for the branches/layer required (see below)</p>
</li>
<li><p class="first">Setup your PG Cache sizes (see below)</p>
</li>
<li><p class="first">Upgrade your <strong>test</strong> server to GeoGig 1.1.1, pointing to the new database</p>
</li>
<li><p class="first">Test until you are satisfied that GeoGig is working in your environment and the datasets are working as expected</p>
</li>
<li><p class="first">Repeat steps 2-5 to set up a new production database</p>
</li>
<li><p class="first">Upgrade your production server to GeoGig 1.1.1, pointing to the new production database</p>
</li>
</ol>
</div>
<div class="section" id="cache-configuration">
<h2>Cache Configuration<a class="headerlink" href="#cache-configuration" title="Permalink to this headline">¶</a></h2>
<p>The cache’s configuration has been greatly simplified.  Please follow these documentation links for how to configure it and see statistics:</p>
<p><a class="reference external" href="http://geogig.org/docs/start/runtime.html">Cache runtime configuration</a>
<a class="reference external" href="http://geogig.org/docs/interaction/geoserver_ui.html#geogig-runtime-settings">GeoServer GUI cache configuration</a></p>
</div>
<div class="section" id="postgresql-driver-upgrade">
<h2>PostgreSQL driver upgrade<a class="headerlink" href="#postgresql-driver-upgrade" title="Permalink to this headline">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you are using GeoServer 2.12 or later, you do not have to upgrade the PostgreSQL driver version (its the new GeoServer default).</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You will get a <cite>java.lang.IllegalStateException: PostgreSQL JDBC Driver version not supported by GeoGig: 9.4</cite> if you have not upgraded your PostgreSQL driver.</p>
</div>
<p>GeoGig’s networking communication has been greatly improved. Binary transfers have been improved by 25%!</p>
<p>For GeoServer versions 2.9 to 2.11, you must use a newer PostgreSQL JDBC Driver (version 42.1.1).  The upgrade is simple -
remove the old postgresql driver and add the new one.</p>
<p>If you are building with maven - you may have to add a dependency on the correct PostgreSQL driver to have it included.  You may also
have to use exclusions to prevent the old version from being added.  Manually check that <em>only</em> the new PostgreSQL driver is being used.
For help in seeing dependencies, you can use <cite>mvn dependency:tree</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="o">&lt;</span><span class="n">exclusion</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="n">postgresql</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">postgresql</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">exclusion</span><span class="o">&gt;</span>
<span class="o">...</span>

<span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="n">postgresql</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">postgresql</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
    <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="mf">42.1</span><span class="o">.</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Please see the <a class="reference external" href="http://geogig.org/docs/start/installation.html#geoserver-plug-in">GeoServer plugin installation guide</a> for detailed instructions.</p>
</div>
<div class="section" id="using-geogig-1-1-1-in-the-cloud">
<h2>Using GeoGig 1.1.1 in the Cloud<a class="headerlink" href="#using-geogig-1-1-1-in-the-cloud" title="Permalink to this headline">¶</a></h2>
<p>GeoGig 1.1.1 has been updated to work with various GeoServer clustered environments.  This work mostly ensures that new repos
added (or modified) are known to all the GeoServers in the cluster.  GeoGig is already designed to allow multiple simultaneous
connections and modifications to the same PostgreSQL dataset.</p>
<div class="section" id="clustered-do-not-use-rocksdb">
<h3>Clustered - do not use RocksDB<a class="headerlink" href="#clustered-do-not-use-rocksdb" title="Permalink to this headline">¶</a></h3>
<p>GeoGIG should <em>only</em> be used with the PostgreSQL backend in a clustered environment.  The GeoGig RocksDB backend cannot be
used by more than one GeoGig process at a time and some cloud filesystems would not efficiently allow the files to be shared.</p>
<p>TODO: add POM/deployment information here for the postgresql/rocks providers</p>
</div>
<div class="section" id="clustered-geogig-async-operation">
<h3>Clustered - GeoGig async operation<a class="headerlink" href="#clustered-geogig-async-operation" title="Permalink to this headline">¶</a></h3>
<p>There are some asynchronous operations in GeoGig - these operations start a process that can be monitored for completion.
Unfortunately, these operations are only known about on the node that they were started on.  In the general cloud case, the
process could be started on one node and the request to monitor for completion could be performed on another node
(who doesn’t know anything about the async operation).</p>
<p>In a clustered environment, the async operation and monitoring requests must be directed to the same node.  This can be
done by either directly talking to a node or (better) having the load balancer direct the requests to the same node.</p>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="Upgrade_1.0_to_1.1.html" title="previous chapter">Upgrading to GeoGig 1.1</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="Upgrade_1.1.1_to_1.2.html" title="next chapter">Upgrading to GeoGig 1.2.0</a></div>
      </div>
      <p class="centered-text"><a href="#top"><img src="_static/arrow_up.png" alt="back to top"/></a></p>
      </div><!-- /#content> -->
  <div id="sidebar" class="sidebar-offcanvas contrast col-sm-4 sidebar-offcanvas" id="sidebar" role="navigation">

    <div>
         <form id="quick-search" action="search.html" method="get" style="width: 100%;">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
          </fieldset>
        </form>


        <div class="btn-group-vertical" id="docs_toc">
          <a class="btn btn-default" href="/docs/">User Manual</a>
          <a class="btn btn-default" href="/technical/">Technical Manual</a>
          <a class="btn btn-default" href="/manpages/">Man Pages</a>
          <a class="btn btn-default" href="/workshop/">Workshop</a>
          <a class="btn btn-default" href="/upgrade/">Upgrading</a>
      </div>
      <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Upgrading to GeoGig 1.1.1</a><ul>
<li><a class="reference internal" href="#upgrading-existing-repositories">Upgrading existing repositories</a></li>
<li><a class="reference internal" href="#cache-configuration">Cache Configuration</a></li>
<li><a class="reference internal" href="#postgresql-driver-upgrade">PostgreSQL driver upgrade</a></li>
<li><a class="reference internal" href="#using-geogig-1-1-1-in-the-cloud">Using GeoGig 1.1.1 in the Cloud</a><ul>
<li><a class="reference internal" href="#clustered-do-not-use-rocksdb">Clustered - do not use RocksDB</a></li>
<li><a class="reference internal" href="#clustered-geogig-async-operation">Clustered - GeoGig async operation</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section continue_reading">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="Upgrade_1.0_to_1.1.html" title="previous chapter">Upgrading to GeoGig 1.1</a></li>
            <li>Next: <a href="Upgrade_1.1.1_to_1.2.html" title="next chapter">Upgrading to GeoGig 1.2.0</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="_sources/Upgrade_1.1_to_1.1.1.rst.txt">Show Source</a></li>
        </ul>
        </div>
        <div class="section">
          <h3>License</h3>
          <p>GeoGig is published using the <a href="https://github.com/locationtech/geogig/blob/master/LICENSE.txt">Eclipse Distribution License</a> (EDL). This is an open source initiative approved BSD-3 Clause license.</p>
          
          <p>This documentation is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. Page template includes work by the JQuery Foundation (<a href="https://github.com/jquery/jquery/blob/master/LICENSE.txt">MIT License</a>).</p>
        </div>

  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div>
</div>

</div><!-- /#main -->
    <footer>
      <div class="container">
        <div class="row">
          <div class=""><p class="repo-owner"><a href="https://github.com/locationtech/geogig">GeoGig</a> available on LocationTech. Website maintained by <a href="https://github.com/boundlessgeo"><img src="_static/Boundless_Logo.png" alt="Boundless"></a></p></div>
        </div>
      </div>
    </footer>


  <script type="text/javascript" src="_static/jquery.js"></script>
  <script type="text/javascript" src="_static/jquery-migrate-min.js"></script>
  <script type="text/javascript" src="_static/bootstrap.min.js" ></script>
  <script type="text/javascript" src="_static/underscore.js"></script>
  <script type="text/javascript" src="_static/doctools.js"></script>
  <script type="text/javascript" src="_static/searchtools.js"></script>
  <script type="text/javascript" src="searchindex.js"></script>
  <script>
      $(document).ready(function() {

      $('[data-toggle=offcanvas]').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
      $('.list-group-item').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
    });
  </script>
  <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-3879903-19']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
  </script>
  </body>
</html>
