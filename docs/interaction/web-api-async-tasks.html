<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, maximum-scale=1">
  
  <title>Web API: Asynchronous tasks &mdash; GeoGig 1.2 User Manual</title>
  <link href='http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,700italic,800italic,300,700,600,800,400' rel='stylesheet' type='text/css'>
  <link href='http://fonts.googleapis.com/css?family=Cantarell:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="../_static/screen.css" type="text/css" media="screen, projection" />
  <link rel="stylesheet" href="../_static/print.css" type="text/css" media="print" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
   <link rel="stylesheet" href="../_static/bootstrap.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/offcanvas.css" type="text/css" />
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.2',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html'
    };
  </script>
      <link rel="index" title="Index" href="../genindex.html" />
      <link rel="search" title="Search" href="../search.html" />
      <link rel="top" title="GeoGig 1.2 User Manual" href="../index.html" />
      <link rel="up" title="Other ways to interact with GeoGig" href="index.html" />
      <link rel="next" title="Web API: Issues" href="web-api-issues.html" />
      <link rel="prev" title="Web API: Serving and Managing Repositories" href="web-api-repository-management.html" />
</head>
<body class="interaction/web-api-async-tasks">
    <div id="blacktop"></div>
    <header id="masthead">
      <div class="navbar">
        <div class="container">
          <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://geogig.org"><h1>GeoGig</h1></a>
          </div>
          <div class="navbar-collapse collapse navbar-right">
            <ul class="nav navbar-nav">
              <li><a href="http://geogig.org/#install">Get Started</a></li>
              <li><a href="http://geogig.org/docs/index.html">Documentation</a></li>
              <li><a href="https://github.com/locationtech/geogig">On Github</a></li>
            </ul>
          </div><!--/.navbar-collapse -->
        </div>
      </div>
    </header>

    <section class="subheading hidden-xs">
      <div class="container">
        <div class="row">
          <div class="col-md-8">
            <p class="byline">A Tool for Geospatial Data Management</p>
          </div>
        </div>
      </div>
    </section>
    <a name="top"></a>

 <div id="main">
    <div class="wrap selfclear">
      <div id="content">
      <div class="container">
        <div class="row row-offcanvas row-offcanvas-right">
          <div class="col-md-8">
            <div class="row pull-right">
             <div class="visible-sm visible-xs" id="menu-btn">
                <button class="btn btn-blue btn-sm"type="button" data-toggle="offcanvas">
                  <span class="btn-text active">Menu &rarr;</span>
                  <span class="btn-back">&larr; Back</span>
                </button>
              </div>
            </div>
<ul id="breadcrumbs">
  
  <li><a href="../index.html">GeoGig 1.2 User Manual</a> &raquo;</li>
  <li><a href="index.html" accesskey="U">Other ways to interact with GeoGig</a> &raquo;</li>
  <li>Web API: Asynchronous tasks</li>
</ul>
<ul id="relatedlinks" class="selfclear">
  <li class="first">
    <a href="../genindex.html" title="General Index"
       accesskey="I">index</a></li>
  <li>
    <a href="web-api-issues.html" title="Web API: Issues"
       accesskey="N">next</a>|</li>
  <li>
    <a href="web-api-repository-management.html" title="Web API: Serving and Managing Repositories"
       accesskey="P">previous</a>|</li>
</ul>
        
  <div class="section" id="web-api-asynchronous-tasks">
<h1>Web API: Asynchronous tasks<a class="headerlink" href="#web-api-asynchronous-tasks" title="Permalink to this headline">¶</a></h1>
<p>Some web API commands can run for a long time depending on how much data they’re dealing with, and hence,
are executed asynchronously, meaning that, once invoked, they start the job in a background thread and return immediately.</p>
<p>The response contains a unique identifier for the asynchronous task and information on the task’s running status.
This task identifier can then be used to poll the status of the task by querying the <code class="docutils literal notranslate"><span class="pre">/tasks/&lt;task</span> <span class="pre">id&gt;</span></code> API endpoint.</p>
<p>If no task is given, e.g. by querying the <code class="docutils literal notranslate"><span class="pre">/tasks</span></code> endpoint, a list of all available tasks will be returned.</p>
<p>A running task can be canceled with the <code class="docutils literal notranslate"><span class="pre">cancel=true</span></code> argument. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8182/tasks/3?cancel=true
</pre></div>
</div>
<p>This request will ask the operation to cancel and return immediately. Note, however, that it may take some time for the cancellation request to complete, as the running task may be blocking on I/O or in a temporarily non-cancelable state. Polling the task repeatedly with the
<code class="docutils literal notranslate"><span class="pre">cancel=true</span></code> parameter is not a problem, though.</p>
<p>Finished tasks, whether they finished successfully, an error occurred, or were canceled, will be kept in memory for 10 minutes in order to allow their status to be queried.
Finished tasks can be explicitly pruned with the <code class="docutils literal notranslate"><span class="pre">prune=true</span></code> parameter. For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>http://localhost:8182/tasks/3?prune=true
</pre></div>
</div>
<p>Prune has no effect on unfinished tasks.</p>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>When the command is invoked, it returns a result such as the following XML-formatted response.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">task</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span><span class="mi">5</span><span class="o">&lt;/</span><span class="nb">id</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">status</span><span class="o">&gt;</span><span class="n">RUNNING</span><span class="o">&lt;/</span><span class="n">status</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="p">{</span><span class="n">command</span> <span class="n">description</span><span class="p">}</span><span class="o">&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">atom</span><span class="p">:</span><span class="n">link</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">atom</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2005/Atom&quot;</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;alternate&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;http://localhost:8182/tasks/5.xml&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;application/xml&quot;</span><span class="o">/&gt;</span>
   <span class="o">&lt;</span><span class="n">progress</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">task</span><span class="o">&gt;</span><span class="n">Connecting</span> <span class="n">to</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">overpass</span><span class="o">-</span><span class="n">api</span><span class="o">.</span><span class="n">de</span><span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">interpreter</span><span class="o">...&lt;/</span><span class="n">task</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">amount</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="o">&lt;/</span><span class="n">amount</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">progress</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">task</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Or the JSON format:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s2">&quot;task&quot;</span><span class="p">:</span>
   <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="mi">5</span><span class="p">,</span>
      <span class="s2">&quot;status&quot;</span><span class="p">:</span><span class="s2">&quot;RUNNING&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span><span class="s2">&quot;osm download filter: null, bbox: -32.9621,-60.6309,-32.9541,-60.6154&quot;</span><span class="p">,</span>
      <span class="s2">&quot;href&quot;</span><span class="p">:</span><span class="s2">&quot;http://localhost:8182/tasks/5.json&quot;</span>
      <span class="s2">&quot;progress&quot;</span> <span class="p">:</span>
      <span class="p">{</span>
          <span class="s2">&quot;task&quot;</span> <span class="p">:</span> <span class="s2">&quot;Connecting to http://overpass-api.de/api/interpreter...&quot;</span><span class="p">,</span>
          <span class="s2">&quot;amount&quot;</span> <span class="p">:</span> <span class="mf">0.0</span>
      <span class="p">}</span>
   <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Note, the <code class="docutils literal notranslate"><span class="pre">atom:link</span></code> in the XML response and the <code class="docutils literal notranslate"><span class="pre">href</span></code> property in the JSON response, represent the status polling URL for the specific task ID.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">status</span></code> attribute will have one of the following values: <code class="docutils literal notranslate"><span class="pre">WAITING</span></code>, <code class="docutils literal notranslate"><span class="pre">RUNNING</span></code>, <code class="docutils literal notranslate"><span class="pre">FINISHED</span></code>, <code class="docutils literal notranslate"><span class="pre">FAILED</span></code>, <code class="docutils literal notranslate"><span class="pre">CANCELLED</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">WAITING</span></code> means that there are other tasks being run in the thread pool and this one has been scheduled to be run as soon
as a spot frees up in the thread pool. The others are self-explanatory.</p>
<p>The content of the task query response varies slightly depending on the task status.</p>
<p>Running tasks may or may not contain a progress indicator. It will depend on the type of task and how far along the task is at the point the response is generated.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">task</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span><span class="mi">4</span><span class="o">&lt;/</span><span class="nb">id</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">status</span><span class="o">&gt;</span><span class="n">RUNNING</span><span class="o">&lt;/</span><span class="n">status</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span> <span class="n">Importing</span> <span class="n">geopackage</span><span class="o">...&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">atom</span><span class="p">:</span><span class="n">link</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">atom</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2005/Atom&quot;</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;alternate&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;http://localhost:8182/tasks/4.xml&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;application/xml&quot;</span><span class="o">/&gt;</span>
   <span class="o">&lt;</span><span class="n">progress</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">task</span><span class="o">&gt;</span><span class="n">Importing</span> <span class="n">into</span> <span class="n">GeoGig</span> <span class="n">repo</span><span class="o">...&lt;/</span><span class="n">task</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">amount</span><span class="o">&gt;</span><span class="mf">1397120.0</span><span class="o">&lt;/</span><span class="n">amount</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">progress</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">task</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Successfully finished tasks may contain a result summary which is specific to the command executed. The following is an example of the result for a successful OSM import operation.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">task</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="nb">id</span><span class="o">&gt;</span><span class="mi">5</span><span class="o">&lt;/</span><span class="nb">id</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">status</span><span class="o">&gt;</span><span class="n">FINISHED</span><span class="o">&lt;/</span><span class="n">status</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">description</span><span class="o">&gt;</span><span class="n">Importing</span> <span class="n">geopackage</span><span class="o">....&lt;/</span><span class="n">description</span><span class="o">&gt;</span>
   <span class="o">&lt;</span><span class="n">atom</span><span class="p">:</span><span class="n">link</span> <span class="n">xmlns</span><span class="p">:</span><span class="n">atom</span><span class="o">=</span><span class="s2">&quot;http://www.w3.org/2005/Atom&quot;</span> <span class="n">rel</span><span class="o">=</span><span class="s2">&quot;alternate&quot;</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;http://localhost:8182/tasks/5.xml&quot;</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;application/xml&quot;</span><span class="o">/&gt;</span>
   <span class="o">&lt;</span><span class="n">result</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="n">OSMReport</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">latestChangeset</span><span class="o">&gt;</span><span class="mi">17218621</span><span class="o">&lt;/</span><span class="n">latestChangeset</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">latestTimestamp</span><span class="o">&gt;</span><span class="mi">1412698140574</span><span class="o">&lt;/</span><span class="n">latestTimestamp</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">processedEntities</span><span class="o">&gt;</span><span class="mi">901852</span><span class="o">&lt;/</span><span class="n">processedEntities</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">nodeCount</span><span class="o">&gt;</span><span class="mi">865542</span><span class="o">&lt;/</span><span class="n">nodeCount</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">wayCount</span><span class="o">&gt;</span><span class="mi">35778</span><span class="o">&lt;/</span><span class="n">wayCount</span><span class="o">&gt;</span>
         <span class="o">&lt;</span><span class="n">unpprocessedCount</span><span class="o">&gt;</span><span class="mi">4</span><span class="o">&lt;/</span><span class="n">unpprocessedCount</span><span class="o">&gt;</span>
      <span class="o">&lt;/</span><span class="n">OSMReport</span><span class="o">&gt;</span>
   <span class="o">&lt;/</span><span class="n">result</span><span class="o">&gt;</span>
<span class="o">&lt;/</span><span class="n">task</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>And failed tasks contain an exception report.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;task&gt;
   &lt;id&gt;7&lt;/id&gt;
   &lt;status&gt;FAILED&lt;/status&gt;
   &lt;description&gt;Importing geopackage...&lt;/description&gt;
   &lt;atom:link xmlns:atom=&quot;http://www.w3.org/2005/Atom&quot; rel=&quot;alternate&quot; href=&quot;http://localhost:8182/tasks/7.xml&quot; type=&quot;application/xml&quot;/&gt;
   &lt;error&gt;
      &lt;message&gt;Nothing to commit after bea73023a9452a9d64f64264d2911ce1ec2b47f2&lt;/message&gt;
      &lt;stackTrace&gt;
      &lt;![CDATA[
         org.locationtech.geogig.api.porcelain.NothingToCommitException: Nothing to commit after bea73023a9452a9d64f64264d2911ce1ec2b47f2
         at org.locationtech.geogig.api.porcelain.CommitOp._call(CommitOp.java:320)
         at org.locationtech.geogig.api.porcelain.CommitOp._call(CommitOp.java:57)
         at org.locationtech.geogig.api.AbstractGeoGigOp.call(AbstractGeoGigOp.java:133)
         at org.locationtech.geogig.osm.internal.OSMImportOp._call(OSMImportOp.java:234)
         at org.locationtech.geogig.osm.internal.OSMImportOp._call(OSMImportOp.java:75)
         at org.locationtech.geogig.api.AbstractGeoGigOp.call(AbstractGeoGigOp.java:133)
         at org.locationtech.geogig.osm.internal.OSMDownloadOp._call(OSMDownloadOp.java:155)
         at org.locationtech.geogig.osm.internal.OSMDownloadOp._call(OSMDownloadOp.java:28)
         at org.locationtech.geogig.api.AbstractGeoGigOp.call(AbstractGeoGigOp.java:133)
         at org.locationtech.geogig.rest.AsyncContext$CommandCall.call(AsyncContext.java:192)
         at java.util.concurrent.FutureTask.run(FutureTask.java:262)
         ...
      ]]&gt;
      &lt;/stackTrace&gt;
   &lt;/error&gt;
&lt;/task&gt;
</pre></div>
</div>
</div>
</div>


      <div class="selfclear pagination-nav">
          <div class="leftwise"><strong>Previous</strong>: <a href="web-api-repository-management.html" title="previous chapter">Web API: Serving and Managing Repositories</a></div>
          <div class="rightwise"><strong>Next</strong>: <a href="web-api-issues.html" title="next chapter">Web API: Issues</a></div>
      </div>
      <p class="centered-text"><a href="#top"><img src="../_static/arrow_up.png" alt="back to top"/></a></p>
      </div><!-- /#content> -->
  <div id="sidebar" class="sidebar-offcanvas contrast col-sm-4 sidebar-offcanvas" id="sidebar" role="navigation">

    <div>
         <form id="quick-search" action="search.html" method="get" style="width: 100%;">
          <fieldset>
            <input type="hidden" name="check_keywords" value="yes" />
            <input type="hidden" name="area" value="default" />
            <input id="quick-search-query" type="text" name="q" accessKey="q" name="searchQuery.queryString" size="25" value="Search Documentation&hellip;" size="20" tabindex="3" onblur="if(this.value=='') this.value='Search Documentation&hellip;';" onfocus="if(this.value=='Search Documentation&hellip;') this.value='';" />
          </fieldset>
        </form>


        <div class="btn-group-vertical" id="docs_toc">
          <a class="btn btn-default" href="/docs/">User Manual</a>
          <a class="btn btn-default" href="/technical/">Technical Manual</a>
          <a class="btn btn-default" href="/manpages/">Man Pages</a>
          <a class="btn btn-default" href="/workshop/">Workshop</a>
          <a class="btn btn-default" href="/upgrade/">Upgrading</a>
      </div>
      <h3 class="pngfix">Table Of Contents</h3>
        <ul>
<li><a class="reference internal" href="#">Web API: Asynchronous tasks</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>

        <div class="section-footer"></div>
      </div>
        <div class="section continue_reading">
          <h3>Continue Reading</h3>
          <ul>
            <li>Previous: <a href="web-api-repository-management.html" title="previous chapter">Web API: Serving and Managing Repositories</a></li>
            <li>Next: <a href="web-api-issues.html" title="next chapter">Web API: Issues</a></li>
          </ul>
        </div>
        <div class="section">
        <h3>This Page</h3>
        <ul class="this-page-menu">
          <li><a href="../_sources/interaction/web-api-async-tasks.rst.txt">Show Source</a></li>
        </ul>
        </div>
        <div class="section">
          <h3>License</h3>
          <p>GeoGig is published using the <a href="https://github.com/locationtech/geogig/blob/master/LICENSE.txt">Eclipse Distribution License</a> (EDL). This is an open source initiative approved BSD-3 Clause license.</p>
          
          <p>This documentation is licensed under a <a href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>. Page template includes work by the JQuery Foundation (<a href="https://github.com/jquery/jquery/blob/master/LICENSE.txt">MIT License</a>).</p>
        </div>

  </div><!-- /#sidebar -->
  </div><!-- /.wrap> -->
</div>
</div>

</div><!-- /#main -->
    <footer>
      <div class="container">
        <div class="row">
          <div class=""><p class="repo-owner"><a href="https://github.com/locationtech/geogig">GeoGig</a> available on LocationTech. Website maintained by <a href="https://github.com/boundlessgeo"><img src="../_static/Boundless_Logo.png" alt="Boundless"></a></p></div>
        </div>
      </div>
    </footer>


  <script type="text/javascript" src="../_static/jquery.js"></script>
  <script type="text/javascript" src="../_static/jquery-migrate-min.js"></script>
  <script type="text/javascript" src="../_static/bootstrap.min.js" ></script>
  <script type="text/javascript" src="../_static/underscore.js"></script>
  <script type="text/javascript" src="../_static/doctools.js"></script>
  <script type="text/javascript" src="../_static/searchtools.js"></script>
  <script type="text/javascript" src="../searchindex.js"></script>
  <script>
      $(document).ready(function() {

      $('[data-toggle=offcanvas]').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
      $('.list-group-item').click(function(e) {
        e.stopPropagation();
        $('.row-offcanvas').toggleClass('active');
        $('.btn-back').toggleClass('active');
        $('.btn-text').toggleClass('active');
      });
    });
  </script>
  <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-3879903-19']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
  </script>
  </body>
</html>
